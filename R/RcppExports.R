# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Count Variants and Carriers
#'
#' @param anno (snps x 1) annotation vector with values in c(0, 1, 2).
#' @param geno (n x snps) genotype matrix.
#' @param min_mac Minimum minor allele count for inclusion. Default: 0.
#' @return Data.frame of allele, variant, and carrier counts.
#' @export
Counts <- function(anno, geno, min_mac = 0L) {
    .Call(`_AllelicSeries_Counts`, anno, geno, min_mac)
}

#' Ordinary Least Squares
#'
#' Fits the standard OLS model.
#'
#' @param y (n x 1) Numeric vector.
#' @param X (n x p) Numeric matrix.
#'
#' @return List containing the following:
#' \itemize{
#' \item{Beta}{Regression coefficient.}
#' \item{V}{Outcome variance.}
#' \item{SE}{Standard errors.}
#' \item{Z}{Z-scores.}
#' }
#' @export
OLS <- function(y, X) {
    .Call(`_AllelicSeries_OLS`, y, X)
}

#' Calculate Residual Variance
#'
#' @param y (n x 1) Numeric phenotype vector.
#' @param X (n x q) Numeric covariate matrix.
#'
#' @return Scalar residual variance.
ResidVar <- function(y, X) {
    .Call(`_AllelicSeries_ResidVar`, y, X)
}

#' Calculate Score Statistic
#'
#' @param y (n x 1) Numeric phenotype vector.
#' @param G (n x p) Numeric genotype matrix.
#' @param X (n x q) Numeric covariate matrix.
#' @param v Scalar residual variance.
#'
#' @return Scalar score statistic.
Score <- function(y, G, X, v) {
    .Call(`_AllelicSeries_Score`, y, G, X, v)
}

#' Calculate SKAT Weights
#' @param anno (snps x 1) annotation vector with values in c(0, 1, 2).
#' @param maf (snps x 1) vector of minor allele frequencies.
#' @param weights (3 x 1) vector of annotation category weights.
#' @return (snps x 1) vector of weights for SKAT test.
#' @noRd 
CalcSkatWeights <- function(anno, maf, weights) {
    .Call(`_AllelicSeries_CalcSkatWeights`, anno, maf, weights)
}

#' Get SKAT Eigenvalues
#' @param kernel Symmetric matrix.
#' @return Vector of eigenvalues.
#' @noRd
GetLambda <- function(kernel) {
    .Call(`_AllelicSeries_GetLambda`, kernel)
}

#' SKAT Optimal Parameters
#' @param cov_z Covariance of the Z-scores
#' @param rhos Vector of rho values to evaluate.
#' @return List of optimal parameter values.
#' @noRd 
SkatOptimalParam <- function(cov_z, rhos) {
    .Call(`_AllelicSeries_SkatOptimalParam`, cov_z, rhos)
}

#' Correlation C++
#' 
#' @section Notes:
#' Verified this function is faster that R's built-in correlation function
#' for large genotype matrices.
#'
#' @param x Numeric matrix.
#' @return Numeric matrix of correlation among the columns.
CorCpp <- function(x) {
    .Call(`_AllelicSeries_CorCpp`, x)
}

#' Inverse Variance Meta-Analysis
#' 
#' @param anno (snps x 1) annotation vector with values in c(0, 1, 2).
#' @param beta (snps x 1) vector of effect sizes for 
#'   the coding genetic variants within a gene.
#' @param ld (snps x snps) matrix of correlations among the genetic variants.
#' @param se (snps x 1) vector of standard errors for the effect sizes.
#' @param weights (3 x 1) vector of annotation category weights.
#' @return Data.frame with the following columns \itemize{
#' \item anno: gene annotation
#' \item beta_meta: meta-analyzed effect size
#' \item se_meta: standard error of the meta-analyzed effect size
#' }
IVWCpp <- function(anno, beta, se, ld, weights) {
    .Call(`_AllelicSeries_IVWCpp`, anno, beta, se, ld, weights)
}

#' Category Correlation
#' 
#' @param anno (snps x 1) annotation vector with values in c(0, 1, 2).
#' @param ld (snps x snps) matrix of correlations among the genetic variants.
#' @param maf (snps x 1) vector of minor allele frequencies.
CatCor <- function(anno, ld, maf) {
    .Call(`_AllelicSeries_CatCor`, anno, ld, maf)
}

#' Baseline Counts Test from Sumstats
#'
#' @param beta (snps x 1) vector of effect sizes for 
#'   the coding genetic variants within a gene.
#' @param ld (snps x snps) matrix of correlations among the genetic variants.
#' @param se (snps x 1) vector of standard errors for the effect sizes.
#' @return Numeric p-value.
#' @export
BaseCountsSS <- function(beta, ld, se) {
    .Call(`_AllelicSeries_BaseCountsSS`, beta, ld, se)
}

